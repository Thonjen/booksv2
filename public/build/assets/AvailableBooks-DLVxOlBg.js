import{i as f,r as k,c as w,w as B,o as r,b as e,j as g,v as x,f as i,q as p,n as m,d as h,t as o,F as u,g as c,l as D,e as C}from"./app-CyrrLprq.js";import{L as R}from"./FrontEndLayout-GOl67bxJ.js";import{_ as q}from"./Modal-DX_abC3j.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={components:{Link:f,Layout:R,Modal:q},props:{books:Array,bookRequests:Array},data(){return{activeTab:"books",searchQuery:"",showModal:!1,editBookData:{id:null,title:"",author:"",availability:"Available",availabilityDate:"",image_url:null},tabs:[{label:"All Books",value:"books"},{label:"Requests",value:"requests"},{label:"Borrowed",value:"borrowed"},{label:"Reserved",value:"reserved"}],requestForm:{type:"borrow",request_date:"",return_date:"",book_id:null}}},computed:{filteredBooks(){return this.books.filter(l=>l.title.toLowerCase().includes(this.searchQuery.toLowerCase()))},borrowedBooks(){return this.books.filter(l=>l.availability==="Borrowed")},reservedBooks(){return this.books.filter(l=>l.availability==="Reserved")},pendingRequests(){return this.bookRequests.filter(l=>l.status==="pending")},historyRequests(){return this.bookRequests.filter(l=>l.status==="rejected"||l.status==="approved")}},methods:{getStatusClass(l){return{Available:"bg-green-100 text-green-800",Borrowed:"bg-red-100 text-red-800",Reserved:"bg-yellow-100 text-yellow-800"}[l]||"bg-gray-100 text-gray-800"},getTabCount(l){switch(l){case"books":return this.books.length;case"borrowed":return this.books.filter(s=>s.availability==="Borrowed").length;case"reserved":return this.books.filter(s=>s.availability==="Reserved").length;case"requests":return this.bookRequests.length}},async approveRequest(l){try{await this.$inertia.patch(route("book-requests.approve",l))}catch{alert("Error approving request")}},async rejectRequest(l){try{await this.$inertia.patch(route("book-requests.reject",l))}catch{alert("Error rejecting request")}},returnBook(l){this.$inertia.post(route("receipts.return",l),{action_type:"return",return_date:new Date().toISOString()})},cancelReservation(l){this.$inertia.delete(route("reserve.destroy",l),{data:{action_type:"cancellation",cancellation_date:new Date().toISOString()}})},formatDate(l){return l?new Date(l).toLocaleDateString():""},updateBook(l){this.editBookData={id:l.id,title:l.title,author:l.author,availability:l.availability||"Available",availabilityDate:l.availabilityDate||"",image_url:l.image_url},this.showModal=!0},saveBook(){const l=new FormData;l.append("_method","PUT"),l.append("title",this.editBookData.title),l.append("author",this.editBookData.author),l.append("availability",this.editBookData.availability),this.editBookData.image_url instanceof File&&l.append("image",this.editBookData.image_url),this.$inertia.post(route("books.update",this.editBookData.id),l,{preserveScroll:!0,onSuccess:()=>{this.closeModal()}})},handleImageUpload(l){const s=l.target.files[0];s&&(this.editBookData.image_url=s)},closeModal(){this.showModal=!1,this.editBookData={id:null,title:"",author:"",availability:"Available",availabilityDate:"",image_url:null}},showRequestModal(l){this.requestForm.book_id=l.id,this.showRequestModal=!0},closeRequestModal(){this.requestForm={type:"borrow",request_date:"",return_date:"",book_id:null},this.showRequestModal=!1},submitRequest(){this.$inertia.post(route("book-requests.store"),this.requestForm),this.closeRequestModal()}}},S={class:"ml-64 p-8 flex-1 bg-gradient-to-br from-gray-50 to-gray-200 min-h-screen"},T={class:"p-6 bg-white shadow rounded-lg"},j={class:"flex items-center bg-gray-100 p-4 rounded-lg shadow-inner mb-6"},U={class:"mb-6 flex space-x-4"},L=["onClick"],F={class:"ml-2 bg-white text-blue-500 rounded-full px-2 py-1 text-xs"},I={key:0,class:"min-w-full"},N={class:"px-4 py-2"},V=["src"],E={class:"px-4 py-2"},P={class:"text-gray-700 font-medium"},Q={class:"px-4 py-2"},z={class:"px-4 py-2"},O={class:"px-4 py-2"},H={class:"flex flex-col"},G={key:0,class:"text-sm text-gray-600"},J={key:1,class:"text-sm text-gray-600"},K={class:"px-4 py-2 flex justify-center space-x-2"},W=["onClick"],X=["onClick"],Y={key:1,class:"min-w-full"},Z={class:"px-4 py-2"},$={class:"px-4 py-2"},ee={class:"px-4 py-2"},te={class:"px-4 py-2"},se={class:"px-4 py-2"},le=["onClick"],oe={key:2,class:"min-w-full"},ae={class:"px-4 py-2"},re={class:"px-4 py-2"},ie={class:"px-4 py-2"},ne={class:"px-4 py-2"},de={class:"px-4 py-2"},ue=["onClick"],ce={class:"min-w-full mb-8"},pe={class:"px-4 py-2"},ye={class:"px-4 py-2"},be={class:"px-4 py-2 capitalize"},he={class:"px-4 py-2"},ge={class:"px-4 py-2"},xe={class:"px-4 py-2"},me={class:"px-4 py-2 space-x-2"},_e=["onClick"],ve=["onClick"],fe={class:"min-w-full"},ke={class:"px-4 py-2"},we={class:"px-4 py-2"},Be={class:"px-4 py-2"},De={class:"px-4 py-2"},Ce={class:"px-4 py-2"},Re={class:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md"},qe={class:"mb-4"},Ae={class:"mb-4"},Me={class:"mb-4"},Se={class:"mb-4"},Te=["src"],je={class:"mb-4"},Ue={class:"flex justify-between mt-6 space-x-4"};function Le(l,s,Fe,Ie,n,a){const _=k("Layout");return r(),w(_,null,{default:B(()=>[e("div",S,[e("main",T,[e("div",j,[s[8]||(s[8]=e("img",{src:"/img/icon.png",class:"w-6 h-6 mr-3 opacity-70",alt:"Search Icon"},null,-1)),g(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=t=>n.searchQuery=t),placeholder:"Search for a book...",class:"w-full p-3 bg-transparent text-gray-700 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded"},null,512),[[x,n.searchQuery]])]),e("div",U,[(r(!0),i(u,null,p(n.tabs,t=>(r(),i("button",{key:t.value,onClick:d=>n.activeTab=t.value,class:m(["px-4 py-2 rounded-lg",n.activeTab===t.value?"bg-blue-500 text-white":"bg-gray-200"])},[h(o(t.label)+" ",1),e("span",F,o(a.getTabCount(t.value)),1)],10,L))),128))]),n.activeTab==="books"?(r(),i("table",I,[s[11]||(s[11]=e("thead",{class:"bg-blue-50 text-gray-600 text-sm uppercase tracking-wider"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left"},"Cover"),e("th",{class:"px-4 py-2 text-left"},"Title"),e("th",{class:"px-4 py-2 text-left"},"Author"),e("th",{class:"px-4 py-2 text-left"},"Book ID"),e("th",{class:"px-4 py-2 text-left"},"Availability"),e("th",{class:"px-4 py-2 text-center"},"Actions")])],-1)),e("tbody",null,[(r(!0),i(u,null,p(a.filteredBooks,t=>(r(),i("tr",{key:t.id},[e("td",N,[e("img",{src:t.image_url||"/img/default-book.jpg",alt:"Book Cover",class:"w-full h-20 object-cover"},null,8,V)]),e("td",E,[e("span",P,o(t.title),1)]),e("td",Q,o(t.author),1),e("td",z,o(t.bookId),1),e("td",O,[e("div",H,[e("span",{class:m(a.getStatusClass(t.availability))},o(t.availability),3),t.availability==="Borrowed"&&t.current_borrower?(r(),i("span",G,[h(" Borrowed by: "+o(t.current_borrower.fullname)+" ",1),s[9]||(s[9]=e("br",null,null,-1)),h(" Due: "+o(a.formatDate(t.current_borrower.due_date)),1)])):c("",!0),t.availability==="Reserved"&&t.current_reserver?(r(),i("span",J,[h(" Reserved by: "+o(t.current_reserver.fullname)+" ",1),s[10]||(s[10]=e("br",null,null,-1)),h(" Until: "+o(a.formatDate(t.current_reserver.until_date)),1)])):c("",!0)])]),e("td",K,[e("button",{onClick:d=>a.updateBook(t),class:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition"}," Edit ",8,W),e("button",{onClick:d=>l.deleteBook(t.id),class:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition"}," Delete ",8,X)])]))),128))])])):c("",!0),n.activeTab==="borrowed"?(r(),i("table",Y,[s[12]||(s[12]=e("thead",{class:"bg-blue-50"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Book"),e("th",{class:"px-4 py-2"},"Borrower"),e("th",{class:"px-4 py-2"},"Phone Number"),e("th",{class:"px-4 py-2"},"Due Date"),e("th",{class:"px-4 py-2"},"Actions")])],-1)),e("tbody",null,[(r(!0),i(u,null,p(a.borrowedBooks,t=>{var d,y,b;return r(),i("tr",{key:t.id},[e("td",Z,o(t.title),1),e("td",$,o((d=t.current_borrower)==null?void 0:d.fullname),1),e("td",ee,o(((y=t.current_borrower)==null?void 0:y.phone_number)||"N/A"),1),e("td",te,o(a.formatDate((b=t.current_borrower)==null?void 0:b.due_date)),1),e("td",se,[e("button",{onClick:v=>a.returnBook(t.id),class:"bg-green-500 text-white px-3 py-1 rounded"}," Return ",8,le)])])}),128))])])):c("",!0),n.activeTab==="reserved"?(r(),i("table",oe,[s[13]||(s[13]=e("thead",{class:"bg-blue-50"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Book"),e("th",{class:"px-4 py-2"},"Reserved By"),e("th",{class:"px-4 py-2"},"Phone Number"),e("th",{class:"px-4 py-2"},"Until Date"),e("th",{class:"px-4 py-2"},"Actions")])],-1)),e("tbody",null,[(r(!0),i(u,null,p(a.reservedBooks,t=>{var d,y,b;return r(),i("tr",{key:t.id},[e("td",ae,o(t.title),1),e("td",re,o((d=t.current_reserver)==null?void 0:d.fullname),1),e("td",ie,o(((y=t.current_reserver)==null?void 0:y.phone_number)||"N/A"),1),e("td",ne,o(a.formatDate((b=t.current_reserver)==null?void 0:b.until_date)),1),e("td",de,[e("button",{onClick:v=>a.cancelReservation(t.id),class:"bg-red-500 text-white px-3 py-1 rounded"}," Cancel ",8,ue)])])}),128))])])):c("",!0),n.activeTab==="requests"?(r(),i(u,{key:3},[s[16]||(s[16]=e("h3",{class:"text-lg font-semibold mb-4"},"Pending Requests",-1)),e("table",ce,[s[14]||(s[14]=e("thead",{class:"bg-blue-50"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Book"),e("th",{class:"px-4 py-2"},"Requester"),e("th",{class:"px-4 py-2"},"Type"),e("th",{class:"px-4 py-2"},"Start Date"),e("th",{class:"px-4 py-2"},"End Date"),e("th",{class:"px-4 py-2"},"Status"),e("th",{class:"px-4 py-2"},"Actions")])],-1)),e("tbody",null,[(r(!0),i(u,null,p(a.pendingRequests,t=>(r(),i("tr",{key:t.id},[e("td",pe,o(t.book.title),1),e("td",ye,o(t.user.fullname),1),e("td",be,o(t.request_type),1),e("td",he,o(a.formatDate(t.request_date)),1),e("td",ge,o(a.formatDate(t.return_date)),1),e("td",xe,[e("span",{class:m({"text-yellow-600":t.status==="pending","text-green-600":t.status==="approved","text-red-600":t.status==="rejected"})},o(t.status),3)]),e("td",me,[e("button",{onClick:d=>a.approveRequest(t.id),class:"bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600"}," Approve ",8,_e),e("button",{onClick:d=>a.rejectRequest(t.id),class:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600"}," Reject ",8,ve)])]))),128))])]),s[17]||(s[17]=e("h3",{class:"text-lg font-semibold mb-4 mt-[20vh]"},"History",-1)),e("table",fe,[s[15]||(s[15]=e("thead",{class:"bg-blue-50"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Book"),e("th",{class:"px-4 py-2"},"Requester"),e("th",{class:"px-4 py-2"},"Type"),e("th",{class:"px-4 py-2"},"Date"),e("th",{class:"px-4 py-2"},"Status")])],-1)),e("tbody",null,[(r(!0),i(u,null,p(a.historyRequests,t=>(r(),i("tr",{key:t.id},[e("td",ke,o(t.book.title),1),e("td",we,o(t.user.fullname),1),e("td",Be,o(t.request_type),1),e("td",De,o(a.formatDate(t.request_date)),1),e("td",Ce,o(t.status),1)]))),128))])])],64)):c("",!0),n.showModal?(r(),i("div",{key:4,class:"fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50 z-50",onClick:s[7]||(s[7]=C((...t)=>a.closeModal&&a.closeModal(...t),["self"]))},[e("div",Re,[s[24]||(s[24]=e("h3",{class:"text-xl font-semibold text-gray-700 mb-4"},"Edit Book Details",-1)),e("div",qe,[s[18]||(s[18]=e("label",{for:"editTitle",class:"block text-sm font-medium text-gray-600"},"Title:",-1)),g(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=t=>n.editBookData.title=t),id:"editTitle",class:"mt-1 p-2 border border-gray-300 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[x,n.editBookData.title]])]),e("div",Ae,[s[19]||(s[19]=e("label",{for:"editAuthor",class:"block text-sm font-medium text-gray-600"},"Author:",-1)),g(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=t=>n.editBookData.author=t),id:"editAuthor",class:"mt-1 p-2 border border-gray-300 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[x,n.editBookData.author]])]),e("div",Me,[s[21]||(s[21]=e("label",{for:"availabilitySelect",class:"block text-sm font-medium text-gray-600"},"Availability:",-1)),g(e("select",{"onUpdate:modelValue":s[3]||(s[3]=t=>n.editBookData.availability=t),id:"availabilitySelect",class:"mt-1 p-2 border border-gray-300 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},s[20]||(s[20]=[e("option",{value:"Available"},"Available",-1),e("option",{value:"Borrowed"},"Borrowed",-1),e("option",{value:"Reserved"},"Reserved",-1)]),512),[[D,n.editBookData.availability]])]),e("div",Se,[s[22]||(s[22]=e("label",{class:"block text-sm font-medium text-gray-600"},"Current Cover:",-1)),e("img",{src:n.editBookData.image_url||"/img/default-book.jpg",alt:"Current Book Cover",class:"h-20 object-cover rounded mt-2"},null,8,Te)]),e("div",je,[s[23]||(s[23]=e("label",{for:"imageUpload",class:"block text-sm font-medium text-gray-600"}," Update Book Cover: ",-1)),e("input",{type:"file",id:"imageUpload",onChange:s[4]||(s[4]=(...t)=>a.handleImageUpload&&a.handleImageUpload(...t)),accept:"image/jpeg,image/png,image/jpg",class:"mt-1 p-2 border border-gray-300 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},null,32)]),e("div",Ue,[e("button",{onClick:s[5]||(s[5]=(...t)=>a.saveBook&&a.saveBook(...t)),class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition w-full"}," Save "),e("button",{onClick:s[6]||(s[6]=(...t)=>a.closeModal&&a.closeModal(...t)),class:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition w-full"}," Cancel ")])])])):c("",!0)])])]),_:1})}const Qe=A(M,[["render",Le]]);export{Qe as default};
