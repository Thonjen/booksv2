import{i as x,Q as y,N as f,r as w,f as u,b as t,j as n,v as d,t as i,d as g,a as h,w as v,g as p,F as b,q as k,e as m,l as M,o as a,n as D}from"./app-CyrrLprq.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const C={components:{Link:x},props:{books:{type:Array,required:!0}},data(){return{searchQuery:"",isModalOpen:!1,isProfileModalOpen:!1,showDropdown:!1,selectedBook:null,requestType:"",startDate:"",returnDate:"",profileForm:{fullname:"",email:"",phone_number:""}}},computed:{user(){return y().props.auth.user},userInitial(){return this.user.fullname.charAt(0)},filteredBooks(){return this.books.filter(r=>r.title.toLowerCase().includes(this.searchQuery.toLowerCase())||r.author.toLowerCase().includes(this.searchQuery.toLowerCase()))}},methods:{toggleDropdown(){this.showDropdown=!this.showDropdown},openModal(r){this.selectedBook=r,this.isModalOpen=!0},closeModal(){this.isModalOpen=!1,this.selectedBook=null},submitRequest(){this.requestType==="reserve"?f.post(route("student.reserve-book"),{book_id:this.selectedBook.id,reservation_date:this.startDate,return_date:this.returnDate},{onSuccess:()=>{this.closeModal(),window.location.reload()},onError:r=>{console.error(r)}}):this.requestType==="borrow"&&f.post(route("book-requests.store"),{book_id:this.selectedBook.id,request_type:"borrow",request_date:this.startDate,return_date:this.returnDate},{onSuccess:()=>{this.closeModal(),window.location.reload()},onError:r=>{console.error(r)}})},openProfileModal(){this.profileForm.fullname=this.user.fullname,this.profileForm.email=this.user.email,this.profileForm.phone_number=this.user.phone_number,this.isProfileModalOpen=!0},closeProfileModal(){this.isProfileModalOpen=!1},updateProfile(){f.put(route("profile.update.basic"),this.profileForm,{onSuccess:()=>{this.closeProfileModal()},onError:r=>{console.log(r)}})}}},P={class:"bg-[#081c2d] text-white py-3 px-6 shadow-sm mb-4 flex items-center justify-between"},_={class:"flex-1 mx-6"},B={class:"flex items-center space-x-4"},F={class:"flex flex-col items-end space-y-0.5"},S={class:"text-sm font-semibold"},O={class:"text-xs text-gray-400"},L={class:"text-xs text-gray-400"},T={key:0,class:"absolute top-12 right-0 w-44 bg-white rounded-lg shadow-md py-1 z-50"},V={class:"container mx-auto p-10"},j={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},N=["onClick"],R=["src"],U={class:"p-4"},E={class:"text-lg font-semibold text-gray-800 truncate"},Q={class:"text-sm text-gray-600 mt-2"},A={class:"text-sm text-gray-600 mt-1"},z={class:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md animate-fade-in relative"},I=["min"],H={class:"block text-sm font-medium text-gray-700"},K=["min"],G={class:"flex justify-end space-x-3"},J=["disabled"],W={class:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md animate-fade-in"},X={class:"flex justify-end space-x-3"};function Y(r,e,Z,$,s,l){const c=w("Link");return a(),u(b,null,[t("header",P,[e[17]||(e[17]=t("div",{class:"flex items-center space-x-4"},[t("img",{src:"/img/logo2.png",alt:"BOOK CLOUD Logo",class:"max-w-[150px] h-auto"})],-1)),t("div",_,[n(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>s.searchQuery=o),placeholder:"Search for books...",class:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200"},null,512),[[d,s.searchQuery]])]),t("div",B,[t("button",{onClick:e[1]||(e[1]=(...o)=>l.toggleDropdown&&l.toggleDropdown(...o)),class:"w-10 h-10 rounded-full bg-[#00509e] flex items-center justify-center text-white text-sm font-semibold shadow-md transition-all hover:scale-105"},i(l.userInitial),1),t("div",F,[t("p",S,i(l.user.fullname),1),t("p",O,i(l.user.studentid),1),t("p",L,i(l.user.phone_number||"No phone number"),1)]),s.showDropdown?(a(),u("div",T,[t("button",{onClick:e[2]||(e[2]=(...o)=>l.openProfileModal&&l.openProfileModal(...o)),class:"block w-full text-left px-4 py-1 text-gray-800 hover:bg-gray-100 rounded-md transition-all duration-200"},e[15]||(e[15]=[t("i",{class:"fas fa-user-circle mr-2 text-lg"},null,-1),g(" Edit Profile ")])),h(c,{href:r.route("logout"),method:"post",as:"button",class:"block w-full text-left px-4 py-1 text-gray-800 hover:bg-gray-100 rounded-md transition-all duration-200"},{default:v(()=>e[16]||(e[16]=[t("i",{class:"fas fa-sign-out-alt mr-2 text-lg"},null,-1),g(" Logout ")])),_:1},8,["href"])])):p("",!0)])]),t("main",V,[e[18]||(e[18]=t("h1",{class:"text-2xl font-semibold mb-6"},"Available Books",-1)),t("div",j,[(a(!0),u(b,null,k(l.filteredBooks,o=>(a(),u("div",{key:o.id,onClick:ee=>l.openModal(o),class:"bg-white shadow-md rounded-lg overflow-hidden cursor-pointer hover:scale-105 transition transform"},[t("img",{src:o.image_url||"/img/default-book.jpg",alt:"Book Cover",class:"w-full h-56 object-cover"},null,8,R),t("div",U,[t("h6",E,i(o.title),1),t("p",Q,i(o.description),1),t("p",A,"Author: "+i(o.author),1),t("span",{class:D([{"text-green-600 font-medium":o.availability==="Available","text-red-600 font-medium":o.availability==="Borrowed","text-yellow-600 font-medium":o.availability==="Reserved"},"block mt-2"])},i(o.availability),3)])],8,N))),128))])]),s.isModalOpen?(a(),u("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",onClick:e[8]||(e[8]=m((...o)=>l.closeModal&&l.closeModal(...o),["self"]))},[t("div",z,[e[22]||(e[22]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Request Book",-1)),t("form",{onSubmit:e[7]||(e[7]=m((...o)=>l.submitRequest&&l.submitRequest(...o),["prevent"])),class:"space-y-4"},[t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700"},"Request Type:",-1)),n(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>s.requestType=o),class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",required:""},e[19]||(e[19]=[t("option",{value:""},"Select a request type",-1),t("option",{value:"borrow"},"Borrow",-1),t("option",{value:"reserve"},"Reserve",-1)]),512),[[M,s.requestType]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700"},"Start Date:",-1)),n(t("input",{type:"date","onUpdate:modelValue":e[4]||(e[4]=o=>s.startDate=o),class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",min:new Date().toISOString().split("T")[0],required:""},null,8,I),[[d,s.startDate]])]),t("div",null,[t("label",H,i(s.requestType==="borrow"?"Return Date":"Until Date")+": ",1),n(t("input",{type:"date","onUpdate:modelValue":e[5]||(e[5]=o=>s.returnDate=o),class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",min:s.startDate,required:""},null,8,K),[[d,s.returnDate]])]),t("div",G,[t("button",{type:"button",onClick:e[6]||(e[6]=(...o)=>l.closeModal&&l.closeModal(...o)),class:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg"}," Cancel "),t("button",{type:"submit",class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!s.requestType||!s.startDate||!s.returnDate}," Submit Request ",8,J)])],32)])])):p("",!0),s.isProfileModalOpen?(a(),u("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",onClick:e[14]||(e[14]=m((...o)=>l.closeProfileModal&&l.closeProfileModal(...o),["self"]))},[t("div",W,[e[27]||(e[27]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Edit Profile",-1)),t("form",{onSubmit:e[13]||(e[13]=m((...o)=>l.updateProfile&&l.updateProfile(...o),["prevent"])),class:"space-y-4"},[t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700"},"Full Name:",-1)),n(t("input",{type:"text","onUpdate:modelValue":e[9]||(e[9]=o=>s.profileForm.fullname=o),class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",required:""},null,512),[[d,s.profileForm.fullname]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700"},"Email:",-1)),n(t("input",{type:"email","onUpdate:modelValue":e[10]||(e[10]=o=>s.profileForm.email=o),class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",required:""},null,512),[[d,s.profileForm.email]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700"},"Phone Number:",-1)),n(t("input",{type:"tel","onUpdate:modelValue":e[11]||(e[11]=o=>s.profileForm.phone_number=o),class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400"},null,512),[[d,s.profileForm.phone_number]])]),t("div",X,[t("button",{type:"button",onClick:e[12]||(e[12]=(...o)=>l.closeProfileModal&&l.closeProfileModal(...o)),class:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg"}," Cancel "),e[26]||(e[26]=t("button",{type:"submit",class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"}," Save Changes ",-1))])],32)])])):p("",!0)],64)}const se=q(C,[["render",Y],["__scopeId","data-v-7c5f6e54"]]);export{se as default};
